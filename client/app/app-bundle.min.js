var app=angular.module("app",["ngRoute","ngAnimate","ui.bootstrap"]);app.run(["security.service",function(n){n.requestCurrentUser()}]);app.controller("baseCtrl",["$scope","security.service","services.utilities",function(n,t,i){n.logoText="USER PORTAL";n.currentYear=(new Date).getFullYear();n.isSidebarClosed=!1;n.settingsLinkGroup=!1;n.currentUser=t.requestCurrentUser();n.isAuthenticated=t.isAuthenticated();n.logout=function(){t.logout()};n.gotoTop=function(){i.anchorScroll("scrollTop")};i.pageWidth<768&&(n.isSidebarClosed=!0);n.toggleSidebar=function(){n.isSidebarClosed=n.isSidebarClosed?!1:!0};n.$on("$routeChangeStart",function(r,u){if(n.isAuthenticated=t.isAuthenticated(),t.isAuthenticated()||u.$$route.originalPath.indexOf("login")!=-1)n.currentUser=t.requestCurrentUser();else{i.navigateTo("/login");return}if(u&&u.$$route&&u.$$route.originalPath){n.activateDashboardNav=n.activateSettingsNav=n.settingsLinkGroup=n.activateSampleSubNav=n.activateSample2SubNav=!1;switch(u.$$route.originalPath){case"/sample":n.activateSettingsNav=n.settingsLinkGroup=n.activateSampleSubNav=!0;break;case"/sample2":n.activateSettingsNav=n.settingsLinkGroup=n.activateSample2SubNav=!0;break;default:n.activateDashboardNav=!0}}})}]);app.animation(".ajs-fade-animation",function(){return{enter:function(n,t){return n.css("display","none"),n.fadeIn(500,t),function(){n.stop()}},leave:function(n,t){return n.fadeOut(500,t),function(){n.stop()}}}});app.config(["$routeProvider",function(n){n.when("/",{templateUrl:"app/dashboard/dashboard.tpl.html",controller:"dashboardCtrl"}).when("/login",{templateUrl:"common/security/login/login.tpl.html",controller:"loginCtrl"}).when("/profile",{templateUrl:"app/account/profile.tpl.html",controller:"profileCtrl"}).when("/sample",{templateUrl:"app/sample/sample.tpl.html"}).when("/sample2",{templateUrl:"app/sample/sample2.tpl.html"}).otherwise({redirectTo:"/"})}]);angular.module("app").controller("dashboardCtrl",["$scope","dashboardService","security.service",function(n,t,i){n.title="Welcome to the User Portal AngularJS Boilerplate!";n.user=i.requestCurrentUser();t.getDashData(n.user.userId).then(function(t){n.dashData=t})}]);angular.module("app").factory("dashboardService",["$http","services.utilities",function(n,t){return{getDashData:function(n){if(n&&n>0)return t.setAsPromise({totalHits:25,totalShares:6})}}}]);angular.module("app").controller("profileCtrl",["$scope","security.service",function(n,t){n.user=t.requestCurrentUser()}]);angular.module("app").controller("registerCtrl",["$scope","registerService","$modalInstance",function(n,t,i){n.user={};n.register=function(){n.dataLoading=!0;t.createUser(n.user)?(n.registerMsg="Your account has been created! You can now login.",n.registerMsgClass="alert-success"):(n.registerMsg="Registration failed. Please try again.",n.registerMsgClass="alert-danger",n.dataLoading=!1)};n.close=function(){i.close()}}]);angular.module("app").factory("registerService",["$http","$q","services.utilities",function(){return{createUser:function(n){if(n&&n.email&&n.password)return!0}}}]);angular.module("app").factory("security.service",["$http","services.utilities",function(n,t){var i={currentUser:null,login:function(){return n.get("/client/test/sampleData/user.json").then(function(n){return i.currentUser=n.data,i.isAuthenticated()&&t.navigateTo("#/"),i.isAuthenticated()},function(n){return t.handleApiError(n),!1})},logout:function(){i.currentUser=null;t.navigateTo("/login")},sendPswdRecoveryEmail:function(){return!0},requestCurrentUser:function(){if(i.isAuthenticated())return i.currentUser},isAuthenticated:function(){return!!i.currentUser}};return i}]);angular.module("app").controller("loginCtrl",["$scope","security.service","$modal",function(n,t,i){$("#loginModal").modal("show");n.user={email:"fake@myemail.com",password:"pa$$word"};n.forgotPass={};n.login=function(){n.dataLoading=!0;t.login(n.user.email,n.user.password)?$("#loginModal").modal("hide"):(n.loginMsg="Login failed. Please try again.",n.dataLoading=!1)};n.forgotPassword=function(){t.sendPswdRecoveryEmail(n.forgotPass.email)?(n.forgotPassMsg="A password recovery email has been sent.",n.forgotPassMsgClass="alert-success"):(n.forgotPassMsg="Form submission error. Please try again.",n.forgotPassMsgClass="alert-danger")};n.openRegister=function(){var n=i.open({templateUrl:"/client/app/account/register.tpl.html",controller:"registerCtrl"})}}]);angular.module("app").factory("services.utilities",["$rootScope","$q","$window","$location","$anchorScroll","$modal",function(n,t,i,r,u,f){var e={rootLocationPath:"/client/#",pageWidth:i.innerWidth,navigateTo:function(n){r.path(n)},pageRedirect:function(n){i.location.href=n?n:e.rootLocationPath+r.$$path},goBack:function(){i.history.back()},anchorScroll:function(n){r.hash(n);u()},setAsPromise:function(n){var i=t.defer();return i.resolve(n),i.promise},handleApiError:function(n){if(n){var t=n.statusText+" (Error Code: "+n.status+")";n.data!=null&&n.data.message!=null&&(t+="<br/><br/>"+n.data.message);e.showModalMessage(t,"danger",null);console.log(t)}},showModalMessage:function(t,i,r,u){n.modalTitle=r;n.modalMessage=t;n.type=i;u=u?u:"";var e=f.open({scope:n,templateUrl:"/client/common/templates/modalMessage.tpl.html",controller:"modalMessageCtrl",backdrop:"static",size:u})}};return e}]);angular.module("app").controller("modalMessageCtrl",function(n,t){switch(n.type){case"warning":n.modalContentClass="alert-warning";n.modalHeaderClass="modal-header-warning";n.modalTitle||(n.modalTitle="Warning");break;case"danger":n.modalContentClass="alert-danger";n.modalHeaderClass="modal-header-danger";n.modalTitle||(n.modalTitle="Error");break;default:n.modalTitle||(n.modalTitle="Information")}n.close=function(){t.close()}});